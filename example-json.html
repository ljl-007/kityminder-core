<!--
 * @Author: liujinlei liujinlei@zhihuiliu.com
 * @Date: 2022-11-16 17:49:34
 * @LastEditors: liujinlei liujinlei@zhihuiliu.com
 * @LastEditTime: 2022-12-19 11:38:46
 * @FilePath: \kityminder-core\example.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>KityMinder Example</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link href="favicon.ico" type="image/x-icon" rel="shortcut icon" />
    <link rel="stylesheet" href="src/kityminder.css" rel="stylesheet" />

    <style type="text/css">
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }

      .mind {
        height: 100%;
        width: 100%;
        /* width: 250px;
        height: 350px; */
        overflow: auto;
      }

      #minder-view {
        height: 100%;
        width: 100%;
        /* position: absolute;
            border: 1px solid #ccc;
            left: 10px;
            top: 10px;
            bottom: 10px;
            right: 10px; */
      }
    </style>

    <script
      type="text/javascript"
      src="node_modules/kity/dist/kity.min.js"
    ></script>
  </head>
  <body>
    <div class="mind" id="mind-content"></div>
  </body>

  <!-- <script type="text/javascript" src="dist/kityminder.core.js"></script> -->
  <script
    type="text/javascript"
    src="node_modules/seajs/dist/sea-debug.js"
  ></script>
  <script type="text/javascript">
    seajs.config({
      base: './src'
    })
    const data = {
      data: {
        text: '百度产品',
        imageSize: { width: 270, height: 129 },
        type: 0
      },
      children: [
        {
          data: { text: ['调试', '自知则知之'], type: 1, 'font-family': '宋体' }
        },
        {
          data: {
            text: [
              '【题】 1.树木丛生（ ）',
              {
                text_group: [
                  {
                    text_key: '正确人数',
                    text_value: 20,
                    text_key_color: 'green',
                    text_value_color: 'red'
                  },
                  {
                    text_key: '正确率',
                    text_value: '75%',
                    text_ey_color: 'green',
                    text_value_color: 'red'
                  }
                ]
              }
            ],
            type: 1
          }
        },
        { data: { text: '贴吧', type: 1, color: 'red' } },
        { data: { text: '知道', type: 1, 'font-family': '宋体' } },
        { data: { text: '音乐', type: 1 } },
        {
          data: {
            text: '图片',
            hyperlink: 'http://www.baidu.com/more',
            type: 1
          }
        },
        { data: { text: '视频', type: 3 } },
        { data: { text: '地图', type: 3 } },
        { data: { text: '百科', type: 1 } },
        {
          data: {
            text: [
              '测试数据测试数据测试,数据测试数据测试数据测试数据测试数据测试据测试数据测试数据测试数据测试数据',
            ],
            type: 3
          }
        }
      ]
    }
    define('start', function (require) {
      var Minder = require('kityminder').Minder
      var km = (window.km = new Minder())
      let outLine = null,
        background = null
      const ROOT_HOVER_BACKGROUND = '#376CD3'
      const KN_HOVER_BACKGROUND = '#C9DCFF'
      const SUB_HOVER_BACKGROUND = '#EBF2FF'
      const hoverBackground = {
        0: ROOT_HOVER_BACKGROUND,
        1: KN_HOVER_BACKGROUND,
        3: SUB_HOVER_BACKGROUND
      }
      km.on('mouseover', e => {
        const node = e.getTargetNode()
        if (node) {
          const { rc } = node
          background = node.getStyle('background')
          outLine = rc.getItems().find(f => f.__KityClassName === 'Rect')
          outLine && outLine.fill(node.getStyle('hover-background'))
        } else {
          outLine && outLine.fill(background)
        }
      })
      // 创建 km 实例
      /* global kityminder */
      km.renderTo('.mind')
      km.importJson({
        root: data,
        template: 'catalogue',
        theme: 'catalogue-edit'
      })
      setTimeout(() => {
        const box = km._rc.getBoundaryBox()
        const paper = km.getPaper()
        // const mind = document.
        // mind.width = box.width
        // mind.height = box.height
        console.log(paper)
        paper.setStyle({ width: box.width + 50, height: box.height + 50 })
      }, 2000)
    })
    seajs.use('start')
  </script>
</html>
